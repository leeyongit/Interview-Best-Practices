# Redis使用lua脚本
版本：自2.6.0起可用。
时间复杂度：取决于执行的脚本。

## 使用Lua脚本的好处：
* 减少网络开销。可以将多个请求通过脚本的形式一次发送，减少网络时延。
* 原子操作。redis会将整个脚本作为一个整体执行，中间不会被其他命令插入。因此在编写脚本的过程中无需担心会出现竞态条件，无需使用事务。
* 复用。客户端发送的脚本会永久存在redis中，这样，其他客户端可以复用这一脚本而不需要使用代码完成相同的逻辑。

## 如何使用
基本使用
命令格式：
```sh
EVAL script numkeys key [key ...] arg [arg ...]
```
说明：
* script是第一个参数，为Lua 5.1脚本。该脚本不需要定义Lua函数（也不应该）。
* 第二个参数numkeys指定后续参数有几个key。
* key [key ...]，是要操作的键，可以指定多个，在lua脚本中通过KEYS[1], KEYS[2]获取
* arg [arg ...]，参数，在lua脚本中通过ARGV[1], ARGV[2]获取。

参考：
[Redis使用lua脚本](https://www.cnblogs.com/52fhy/p/9786720.html)
